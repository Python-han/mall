{% extends 'baykeShop/user/profile.html' %}

{% load static %}

{% block title %}
地址管理 - {{ request.user }}
{% endblock %}

{% block breadcrumbs %}
    <nav class="breadcrumb is-small mt-5" aria-label="breadcrumbs">
        <ul>
          <li><a href="{% url 'baykeShop:home' %}">首页</a></li>
          <li><a href="{% url 'baykeShop:user_profile' %}">个人中心</a></li>
          <li class="is-active"><a href="#" aria-current="page">地址管理</a></li>
        </ul>
    </nav>
{% endblock %}

{% block profile %}
<div id="userAddress">

    <div class="is-flex is-justify-content-space-between is-align-items-center">
      <h1 class="is-size-5 pl-2">
        <span class="mdi mdi-map-marker-multiple-outline"></span> 
        地址管理
      </h1>
      <div>
        <b-button 
          type="is-primary is-light"  
          icon-left="map-plus" 
          @click="isComponentModalActive = true">添加地址
        </b-button>
      </div>
    </div>
  
    <div class="dropdown-divider"></div>

    <b-modal
        v-model="isComponentModalActive"
        has-modal-card
        :events="events"
        :can-cancel="false">
        <modal-form v-bind="formProps" @save="save"></modal-form>
    </b-modal>

</div>
{% endblock %}

{% block vuescript %}
<script>
    const ModalForm = {
        props: ['email', 'password'],
        data(){
            return {
                formProps: {
                    email: 'asdaasad'
                }
                
            }
        },
        template: `
            <div class="modal-card" style="width: auto">
                <header class="modal-card-head">
                    <p class="modal-card-title">Login</p>
                </header>
                <section class="modal-card-body">
                    <b-field label="Email">
                        <b-input
                            v-model="formProps.email"
                            type="email"
                            :value="formProps.email"
                            placeholder="Your email"
                            required>
                        </b-input>
                    </b-field>

                    <b-field label="Password">
                        <b-input
                            type="password"
                            :value="password"
                            password-reveal
                            placeholder="Your password"
                            required>
                        </b-input>
                    </b-field>

                    <b-checkbox>Remember me</b-checkbox>
                </section>
                <footer class="modal-card-foot">
                    <b-button
                        label="Close"
                        @click="$parent.close()" />
                    <b-button
                        label="Login"
                        @click="save"
                        type="is-primary" />
                </footer>
            </div>
        `,
        methods: {
            save(){
                this.$emit('save', this.$props)
            }
        }
    }

    var userAddress = new Vue({
        el: '#userAddress',
        delimiters: ['{$', '$}'],
        components: {
            ModalForm
        },
        data:{
            events:{
                'save': this.save,
                'email': this.email
            },
            isComponentModalActive: false,
            formProps: {
                email: 'evan@you.com',
                password: 'testing'
            }
        },
        methods: {
            save(formProps){
                console.log(formProps)
            },
            email(){
                console.log('asdasa')
                return 'asdasda'
            }
        }
    })
</script>
{% endblock %}