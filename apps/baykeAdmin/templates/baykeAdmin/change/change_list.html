{% extends 'baykeAdmin/layout.html' %}

{% load i18n static admin_list bayke_admin_list %}

{% block stylesheet %}https://unpkg.com/buefy/dist/buefy.min.css{% endblock %}

{% block menu %}
    {% include 'baykeAdmin/sidebar.html' with app_list=available_apps show_changelinks=False %}
{% endblock %}

{% block content %}
    <div class="p-3" id="changeList">
        {% block search %}{% search_form cl %}{% endblock %}
        <form id="changelist-form" method="post"{% if cl.formset and cl.formset.is_multipart %} enctype="multipart/form-data"{% endif %} novalidate>{% csrf_token %}
        
            {% if action_form and actions_on_top and cl.show_admin_actions %}{% admin_actions %}{% endif %}
            
        <div class="box">
            <div class="box is-shadowless has-background-light">
                {% change_list_object_tools %}
            </div>
            {% show_results cl %}
        </div>
        </form>
    </div>
{% endblock %}

{% block extrafoot %}
    <script src="https://unpkg.com/vue@2"></script>
{% endblock %}

{% block extrascript %}
    <script src="https://unpkg.com/buefy/dist/components/table"></script>
    <script src="https://unpkg.com/buefy/dist/components/input"></script>
    <script>
        var chnangeData = JSON.parse(document.getElementById('change-data').textContent);
        var headersData = JSON.parse(document.getElementById('headers-data').textContent);
    </script>
{% endblock %}

{% block vue %}
    <script>
        var changeList = new Vue({
            el: '#changeList',
            delimiters: ['{$', '$}'],
            data: {
                data: chnangeData,
                columns: headersData,
                path: '{{ request.path }}'
            },
            methods: {
                pageChange(page){
                    location.replace(this.path+'?p='+page);
                }
            }
        })
    </script>
{% endblock %}
    