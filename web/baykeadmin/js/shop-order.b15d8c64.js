"use strict";(self["webpackChunkbaykeshop"]=self["webpackChunkbaykeshop"]||[]).push([[494],{4661:function(e,a,t){t.r(a),t.d(a,{default:function(){return B}});var s=t(6252),l=t(3577);const r={style:{padding:"10px"}},d={class:"left-panel"},o={class:"right-panel"},i={class:"right-panel-search"},n={key:0},u={key:1},w={key:2},p={key:0},k={key:1},c={key:2},h={key:0},m={key:1},g={key:2},_={key:3},y={key:4},f={key:5},b={key:6},D={style:{padding:"0 15px"}},v=(0,s._)("div",{style:{"font-weight":"bold",color:"rgb(44, 44, 44)"}},"收货信息",-1),W={style:{padding:"0 15px"}},z=(0,s._)("div",{style:{"font-weight":"bold",color:"rgb(44, 44, 44)"}},"订单信息",-1),C={key:0},$={key:1},x={key:2},q={key:3},U={key:4},j={key:5},S={key:6},O={key:0},V={key:1},P={key:2},H={key:3},Y={style:{padding:"0 15px"}},A=(0,s._)("div",{style:{"font-weight":"bold",color:"rgb(44, 44, 44)"}},"商品信息",-1);function I(e,a,t,I,K,T){const E=(0,s.up)("sc-select-filter"),F=(0,s.up)("el-card"),Z=(0,s.up)("el-button"),B=(0,s.up)("el-input"),G=(0,s.up)("el-header"),J=(0,s.up)("el-table-column"),L=(0,s.up)("el-image"),M=(0,s.up)("el-col"),N=(0,s.up)("el-divider"),Q=(0,s.up)("el-row"),R=(0,s.up)("el-popconfirm"),X=(0,s.up)("el-button-group"),ee=(0,s.up)("scTable"),ae=(0,s.up)("el-main"),te=(0,s.up)("el-container"),se=(0,s.up)("save-dialog"),le=(0,s.up)("el-drawer");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(te,null,{default:(0,s.w5)((()=>[(0,s._)("div",r,[(0,s.Wm)(F,{shadow:"never",header:"订单筛选"},{default:(0,s.w5)((()=>[(0,s.Wm)(E,{data:K.data,"selected-values":K.selectedValues,"label-width":80,onOnChange:T.change},null,8,["data","selected-values","onOnChange"])])),_:1})]),(0,s.Wm)(G,null,{default:(0,s.w5)((()=>[(0,s._)("div",d,[(0,s.Wm)(Z,{type:"danger",plain:"",icon:"el-icon-delete",onClick:T.batch_del,disabled:!K.ids.length},{default:(0,s.w5)((()=>[(0,s.Uk)("批量删除")])),_:1},8,["onClick","disabled"])]),(0,s._)("div",o,[(0,s._)("div",i,[(0,s.Wm)(B,{modelValue:K.search.keyword,"onUpdate:modelValue":a[0]||(a[0]=e=>K.search.keyword=e),placeholder:"订单号、收件人、手机号",clearable:""},null,8,["modelValue"]),(0,s.Wm)(Z,{type:"primary",icon:"el-icon-search",onClick:T.upsearch},null,8,["onClick"])])])])),_:1}),(0,s.Wm)(ae,{class:"nopadding"},{default:(0,s.w5)((()=>[(0,s.Wm)(ee,{ref:"table",apiObj:K.apiObj,"row-key":"id",onSelectionChange:T.selectionChange},{default:(0,s.w5)((()=>[(0,s.Wm)(J,{type:"selection",width:"50"}),(0,s.Wm)(J,{label:"订单号",prop:"order_sn",width:"180"}),(0,s.Wm)(J,{label:"用户",prop:"owner_data",width:"180"}),(0,s.Wm)(J,{label:"商品信息",prop:"baykeshopordersku_set"},{default:(0,s.w5)((e=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.row.baykeshopordersku_set,(e=>((0,s.wg)(),(0,s.j4)(Q,{key:e.id},{default:(0,s.w5)((()=>[(0,s.Wm)(M,{xs:24,md:6,sm:4},{default:(0,s.w5)((()=>[(0,s.Wm)(L,{style:{width:"50px",height:"50px"},src:e.sku_json.img,fit:"cover"},null,8,["src"])])),_:2},1024),(0,s.Wm)(M,{xs:24,md:13,sm:15},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.sku_json.title)+" ",1),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.sku_json.spec_values,(e=>((0,s.wg)(),(0,s.iD)("span",{key:e.id}," |"+(0,l.zw)(e.value),1)))),128))])),_:2},1024),(0,s.Wm)(M,{md:5},{default:(0,s.w5)((()=>[(0,s._)("span",null,"¥"+(0,l.zw)(e.sku_json.price)+"x"+(0,l.zw)(e.count),1)])),_:2},1024),(0,s.Wm)(N,{"border-style":"dashed",style:{margin:"0"}})])),_:2},1024)))),128))])),_:1}),(0,s.Wm)(J,{label:"实际支付",prop:"total_price"},{default:(0,s.w5)((e=>[e.row.status>1?((0,s.wg)(),(0,s.iD)("span",n,(0,l.zw)(e.row.total_price),1)):7==e.row.status?((0,s.wg)(),(0,s.iD)("span",u,"退款中")):((0,s.wg)(),(0,s.iD)("span",w,"未支付"))])),_:1}),(0,s.Wm)(J,{label:"支付方式",prop:"paymethod"},{default:(0,s.w5)((e=>[1==e.row.paymethod?((0,s.wg)(),(0,s.iD)("span",p,"支付宝支付")):(0,s.kq)("",!0),2==e.row.paymethod?((0,s.wg)(),(0,s.iD)("span",k,"微信支付")):(0,s.kq)("",!0),3==e.row.paymethod?((0,s.wg)(),(0,s.iD)("span",c,"余额支付")):(0,s.kq)("",!0)])),_:1}),(0,s.Wm)(J,{label:"支付时间",prop:"pay_time"}),(0,s.Wm)(J,{label:"订单状态",prop:"status"},{default:(0,s.w5)((e=>[1==e.row.status?((0,s.wg)(),(0,s.iD)("span",h,"待付款")):(0,s.kq)("",!0),2==e.row.status?((0,s.wg)(),(0,s.iD)("span",m,"待发货")):(0,s.kq)("",!0),3==e.row.status?((0,s.wg)(),(0,s.iD)("span",g,"待收货")):(0,s.kq)("",!0),4==e.row.status?((0,s.wg)(),(0,s.iD)("span",_,"待评价")):(0,s.kq)("",!0),5==e.row.status?((0,s.wg)(),(0,s.iD)("span",y,"已完成")):(0,s.kq)("",!0),6==e.row.status?((0,s.wg)(),(0,s.iD)("span",f,"已关闭")):(0,s.kq)("",!0),7==e.row.status?((0,s.wg)(),(0,s.iD)("span",b,"退款中")):(0,s.kq)("",!0)])),_:1}),(0,s.Wm)(J,{label:"操作",fixed:"right",align:"right",width:"170"},{default:(0,s.w5)((e=>[(0,s.Wm)(X,null,{default:(0,s.w5)((()=>[(0,s.Wm)(Z,{text:"",type:"primary",size:"small",onClick:a=>T.table_show(e.row,e.$index)},{default:(0,s.w5)((()=>[(0,s.Uk)("查看")])),_:2},1032,["onClick"]),1==e.row.status?((0,s.wg)(),(0,s.j4)(Z,{key:0,text:"",type:"primary",size:"small",onClick:a=>T.table_edit(e.row,e.$index)},{default:(0,s.w5)((()=>[(0,s.Uk)("编辑")])),_:2},1032,["onClick"])):(0,s.kq)("",!0),2==e.row.status?((0,s.wg)(),(0,s.j4)(Z,{key:1,text:"",type:"primary",size:"small",onClick:a=>T.send_goods(e.row,e.$index)},{default:(0,s.w5)((()=>[(0,s.Uk)("发货")])),_:2},1032,["onClick"])):(0,s.kq)("",!0),1==e.row.status?((0,s.wg)(),(0,s.j4)(R,{key:2,title:"确定删除吗？",onConfirm:a=>T.table_del(e.row,e.$index)},{reference:(0,s.w5)((()=>[(0,s.Wm)(Z,{text:"",type:"primary",size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)("删除")])),_:1})])),_:2},1032,["onConfirm"])):(0,s.kq)("",!0)])),_:2},1024)])),_:1})])),_:1},8,["apiObj","onSelectionChange"])])),_:1})])),_:1}),K.dialog.save?((0,s.wg)(),(0,s.j4)(se,{key:0,ref:"saveDialog",onSuccess:T.handleSaveSuccess,onClosed:a[1]||(a[1]=e=>K.dialog.save=!1)},null,8,["onSuccess"])):(0,s.kq)("",!0),(0,s.Wm)(le,{modelValue:K.drawer,"onUpdate:modelValue":a[2]||(a[2]=e=>K.drawer=e),size:"40%",title:"订单信息","destroy-on-close":""},{default:(0,s.w5)((()=>[(0,s._)("div",D,[v,(0,s.Wm)(Q,null,{default:(0,s.w5)((()=>[(0,s.Wm)(M,{span:12},{default:(0,s.w5)((()=>[(0,s.Uk)("用户："+(0,l.zw)(K.drawerData.owner_data),1)])),_:1}),(0,s.Wm)(M,{span:12},{default:(0,s.w5)((()=>[(0,s.Uk)("收货人："+(0,l.zw)(K.drawerData.name),1)])),_:1}),(0,s.Wm)(M,{span:12},{default:(0,s.w5)((()=>[(0,s.Uk)("联系电话："+(0,l.zw)(K.drawerData.phone),1)])),_:1}),(0,s.Wm)(M,{span:12},{default:(0,s.w5)((()=>[(0,s.Uk)("收货地址："+(0,l.zw)(K.drawerData.address),1)])),_:1})])),_:1})]),(0,s.Wm)(N,{"border-style":"dashed"}),(0,s._)("div",W,[z,(0,s.Wm)(Q,null,{default:(0,s.w5)((()=>[(0,s.Wm)(M,{span:12},{default:(0,s.w5)((()=>[(0,s.Uk)("订单号："+(0,l.zw)(K.drawerData.order_sn),1)])),_:1}),(0,s.Wm)(M,{span:12},{default:(0,s.w5)((()=>[(0,s.Uk)("订单状态： "),1==K.drawerData.status?((0,s.wg)(),(0,s.iD)("span",C,"待付款")):(0,s.kq)("",!0),2==K.drawerData.status?((0,s.wg)(),(0,s.iD)("span",$,"待发货")):(0,s.kq)("",!0),3==K.drawerData.status?((0,s.wg)(),(0,s.iD)("span",x,"待收货")):(0,s.kq)("",!0),4==K.drawerData.status?((0,s.wg)(),(0,s.iD)("span",q,"待评价")):(0,s.kq)("",!0),5==K.drawerData.status?((0,s.wg)(),(0,s.iD)("span",U,"已完成")):(0,s.kq)("",!0),6==K.drawerData.status?((0,s.wg)(),(0,s.iD)("span",j,"已关闭")):(0,s.kq)("",!0),7==K.drawerData.status?((0,s.wg)(),(0,s.iD)("span",S,"退款中")):(0,s.kq)("",!0)])),_:1}),(0,s.Wm)(M,{span:12},{default:(0,s.w5)((()=>[(0,s.Uk)("商品总数："+(0,l.zw)(T.orderSkuCount(K.drawerData.baykeshopordersku_set)),1)])),_:1}),(0,s.Wm)(M,{span:12},{default:(0,s.w5)((()=>[(0,s.Uk)("商品总价："+(0,l.zw)(T.orderSkuTotalPrice(K.drawerData.baykeshopordersku_set)),1)])),_:1}),(0,s.Wm)(M,{span:12},{default:(0,s.w5)((()=>[(0,s.Uk)("实际支付："+(0,l.zw)(K.drawerData.total_price),1)])),_:1}),(0,s.Wm)(M,{span:12},{default:(0,s.w5)((()=>[(0,s.Uk)("创建时间："+(0,l.zw)(K.drawerData.add_date),1)])),_:1}),(0,s.Wm)(M,{span:12},{default:(0,s.w5)((()=>[(0,s.Uk)("支付方式： "),1==K.drawerData.paymethod?((0,s.wg)(),(0,s.iD)("span",O,"支付宝支付")):2==K.drawerData.paymethod?((0,s.wg)(),(0,s.iD)("span",V,"微信支付")):3==K.drawerData.paymethod?((0,s.wg)(),(0,s.iD)("span",P,"余额支付")):((0,s.wg)(),(0,s.iD)("span",H,"未支付"))])),_:1}),(0,s.Wm)(M,{span:12},{default:(0,s.w5)((()=>[(0,s.Uk)("支付时间："+(0,l.zw)(K.drawerData.pay_time),1)])),_:1})])),_:1})]),(0,s.Wm)(N,{"border-style":"dashed"}),(0,s._)("div",Y,[A,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(K.drawerData.baykeshopordersku_set,(e=>((0,s.wg)(),(0,s.j4)(Q,{key:e.id},{default:(0,s.w5)((()=>[(0,s.Wm)(M,{span:5},{default:(0,s.w5)((()=>[(0,s.Wm)(L,{style:{width:"50px",height:"50px"},src:e.sku_json.img,fit:"cover"},null,8,["src"])])),_:2},1024),(0,s.Wm)(M,{span:15},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.sku_json.title)+" ",1),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.sku_json.spec_values,(e=>((0,s.wg)(),(0,s.iD)("span",{key:e.id}," |"+(0,l.zw)(e.value),1)))),128))])),_:2},1024),(0,s.Wm)(M,{md:4},{default:(0,s.w5)((()=>[(0,s._)("span",null,"¥"+(0,l.zw)(e.sku_json.price)+"x"+(0,l.zw)(e.count),1)])),_:2},1024)])),_:2},1024)))),128))])])),_:1},8,["modelValue"])],64)}t(7658);var K=t(6029),T=t(9634),E={name:"shopOrder",components:{scSelectFilter:T.Z,saveDialog:K["default"]},data(){return{data:[{title:"订单状态",key:"status",options:[{label:"全部",value:""},{label:"待付款",value:"1"},{label:"待发货",value:"2"},{label:"待收货",value:"3"},{label:"待评价",value:"4"},{label:"已完成",value:"5"},{label:"已关闭",value:"6"},{label:"退款中",value:"7"}]},{title:"支付方式",key:"paymethod",multiple:!1,options:[{label:"全部",value:""},{label:"支付宝支付",value:"1"},{label:"微信支付",value:"2"},{label:"余额支付",value:"3"}]}],selectedValues:{state:[""],type:[""]},filterData:{},dialog:{save:!1},apiObj:this.$API.shop.order.list,selection:[],search:{keyword:null},ids:[],drawer:!1,drawerData:""}},methods:{change(e){this.filterData=e,this.$refs.table.upData(this.filterData)},add(){console.log("add")},table_show(e){this.drawer=!0,this.drawerData=e},table_edit(e){this.dialog.save=!0,this.$nextTick((()=>{this.$refs.saveDialog.open("edit").setData(e)}))},send_goods(e){this.$API.shop.order.sendgoods.post(e).then((e=>{console.log(e),200==e.status&&(this.$message.success("发货成功"),this.$refs.table.refresh())}))},async table_del(e){var a=await this.$API.shop.order.remove.delete(e.id);204==a.status?(this.$refs.table.refresh(),this.$message.success("删除成功")):this.$alert(a.message,"提示",{type:"error"})},batch_del(){this.$confirm(`确定删除选中的 ${this.selection.length} 项吗？如果删除项中含有子集将会被一并删除`,"提示",{type:"warning"}).then((()=>{const e=this.$loading();this.$API.shop.order.remove.batch_delete({ids:this.ids}).then((a=>{204==a.status&&(this.$refs.table.refresh(),e.close(),this.$message.success("操作成功"))}))})).catch((()=>{}))},upsearch(){let e=Object.assign(this.filterData,{serarch:this.search.keyword});this.$refs.table.upData(e)},selectionChange(e){this.selection=e,this.selection.forEach((e=>{this.ids.push(e.id)}))},handleSaveSuccess(e,a){("add"==a||"edit"==a)&&this.$refs.table.refresh()},orderSkuCount(e){let a=0;return e.forEach((e=>{a+=e.count})),a},orderSkuTotalPrice(e){let a=0;return e.forEach((e=>{a+=parseFloat(e.sku_json.price)})),a}}},F=t(3744);const Z=(0,F.Z)(E,[["render",I]]);var B=Z}}]);