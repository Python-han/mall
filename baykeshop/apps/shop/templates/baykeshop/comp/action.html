<div id="orderaAction{{ order.id }}">
    <p class=" has-text-weight-bold pt-1 pb-1 has-text-right">共{{ payorder.count }}件商品，总金额{{ payorder.total_amount }}元（含运费）</p>
    <div class=" buttons is-justify-content-end">
    {% if order.status == 1 %}
        <a class="button is-primary is-small" href="{% url 'shop:order-confirm' order.id %}">立即支付</a>
    {% elif order.status == 3 %}
        <button class="button is-primary is-small" @click="confirmProduct">确认收货</button>
    {% elif order.status == 4 and not payorder.is_commented %}
        <a class=" button is-primary is-small" href="">立即评价</a>
    {% endif %}
    <a href="{% url 'shop:order-confirmok' order.id %}" class="button is-small">订单详情</a>
    </div>
</div>

<script>
    var confirmAction = new Vue({
        el: '#orderaAction{{ order.id }}',
        delimiters: ['{$', '$}'],
        methods: {
            confirmProduct(){
                request({
                    url:'{% url "shop:order-confirmok" order.id %}',
                    method: 'post'
                }).then(res => {
                    console.log(res)
                    // if (res.status==200) {
                    //     bayke.toastMessage('is-success', "确认收货成功")
                    //     setTimeout(function(){location.reload()}, 2000)
                    // }
                    setTimeout(function(){location.reload()}, 2000)
                })
            }
        }
    })
</script>